| rex field=url "https?://(?<full_domain>[^/]+)"
| lookup allTLDs.csv TLD AS full_domain OUTPUT TLD AS matched_tld
| eval domain=if(isnotnull(matched_tld), replace(full_domain, "." . matched_tld, ""), null())
| eval TLD=if(isnotnull(matched_tld), "." . matched_tld, null())
| table url, full_domain, domain, TLD
